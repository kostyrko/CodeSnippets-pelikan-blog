Title: Docker: wprowadzenie
Author: mkostyrko
Date: 2020-11-18 10:00
Updated:
Category: containers
Tags: docker, containers, kontenery, nodejs, expressjs, express
Slug: docker-wprowadzenie
related_posts: 

![docker-logo](https://www.cloudsavvyit.com/thumbcache/0/0/576bdb68675c300a17d82c131b23c927/p/uploads/2019/06/c454d054.png)

Docker - odtwarzanie/reprodukcja rodowiska, wirtualizuje system operacyjny a nie hardware (jak np. virtual machine) -> docker tworzy "odizolowane mikrokomputery"

![docker-vs-vm](https://miro.medium.com/max/700/0*5zQfr6j2fAeNPy-H.png)

**Docker-file** - plan pozwalajcy na stworzenie docker-image/ tu znajduje si definicja rodowiska (lista zale偶noci) dla Docker-image

**Docker-image** - rodowisko obsugujce docker-kontener贸w/ niezmienne "snapshot" rodowiska

**Docker-Container** - proces/pracujcy (running process) Docker-imag'a

---
### Podstawowe komendy

`docker ps` -> docker process - ukazuje dziaajce dockery (ukazuje min. powizanie z obrazem oraz portem)

`docker build -t userName_dockerHub/nazwa_aplikacji:numer.wersji cie偶kaDoPlikuDockerfile` -> switch -t = **tag** pozwala na przypisanie tagu do dockera w trakcie jego budowy (**build**), umo偶liwia to jego proste odnalezienia / (nazwa u偶ytkownika jest opcjonalna)

    // np.
    docker build -t userName_dockerHub/nazwa_aplikacji:1.0 .

`docker push/pull` - komendy pozwalajce na wypychanie i pobieranie dockera z remota

`docker run` - uruchomienie Dockera

`docker stop $(docker ps -aq)` - zatrzymuje wszystkie pracujce dockery

`docker compose down` - zamyka wszystkie dockery stworzone przez `up`


---

## Prosta nodejs Express Aplikacja

**藕r贸do poni偶szego kodu**: [GH-  fireship-io/docker-nodejs-basic-demo ](https://github.com/fireship-io/docker-nodejs-basic-demo)

wyjciowa aplikacja -> **src/index.js**

        // index.js
        const app = require('express')();

        app.get('/', (req, res ) => 
            res.json({ message: 'Docker jest prosty ' }) 
        );

        const port = process.env.PORT || 8080;

        app.listen(port, () => console.log(`app listening on http://localhost:${port}`) );



### >>> Dockerfile <<<

**1** stworzenie **Dockerfile**

**--------------- dodanie instrukcji (zwanych warstwami) -----------------**

**2** wskazanie rodowiska -> np. `FROM node:12` (wersja 12 node.js)

**3** Dodanie 藕r贸da kodu poprzez zdefiniowanie Working Directory -> np. `WORKDIR /app`

**4** Wskazanie cie偶ki pozwalajcej na skopiowanie zale偶noci -> `COPY package*.json ./` (1. skd 2. dokd)

**5** Wskazanie instrukcji wykonania istalacji pakiet贸w node.js -> `RUN np install`

**6.1** Wskazanie lokalnych modu贸w nodejs do zignorowania w trakcie kopiowania plik贸w lokalnych -> stworzenie **.dockerignore** -> dodanie `node_modules`

**6.2** Skopiowanie kodu 藕r贸dowego (skopowanie plik贸w lokalnych do CWD, wskazanie lokalnych modu贸w do zignorowania w trakcie kopiowania) -> `COPY . .` 

**7** Wskazanie zmienna rodowiskowa pracy -> `ENV PORT=8080`

**8** Zdefiniowanie nasuchiwania (port) -> `EXPOSE 8080`

**9** Command/komenda wskazuje w jaki spos贸b ma pracowa (run) docker -> `CMD ["npm", "start"]`

### Docker Image

**1** Wpisanie komendy w **terminalu** -> `docker build -t nazwa_aplikacji` lub `docker build -t userName_dockerHub/nazwa_aplikacji:1.0 .`

**2** Wypchnicie do remota -> `docker push adres_repozytorium_na_np.DockerHub`

**3** Uruchomienie dockera `docker run idDockera/tagDockera`

**4** Uruchomienie dockera jeli port jest niewidoczny - w贸wczas nale偶y przekierowa port na dostpny `docker run -p 5000:8080 idDockera/tagDockera` (p->port forwarding local:container -> 5000:8080)

**5** Zamknicie Dockera -> `docker stop kluczDockera/id` np `docker stop 11da141426d3a0` `docker stop tagDockera`

### Volumes

- folder do przechowywania informacji/plik贸w, kt贸re zostan zapisane po wyczeniu dockera

    // stworzenie
    docker volume create nazwaFolderu

    // u偶ycie
    --mount source=nazwaFolderu,nazwaKolejnegoFolderu


---
### Docker Hub

[Docker-Hub](https://hub.docker.com/search?q=&type=image) - miejsce (strona) kt贸ra pozwoli na przechowywanie, rozpowszechnianie obraz贸w Dockera oraz na kolaboracj nad/z nimi 

---
### Moby Project - tool to build container-base system przykadowo ten przy u偶yciu LinuxKit


przy u偶yciu Mobiego mo偶na pracowa z LinuxKit w celu stworzenia wasnej dystrybucji Linuxa


![moby i docker](https://collabnix.com/wp-content/uploads/2017/05/moby.png)




---

殴r贸da:

[docs.docker.com](https://docs.docker.com/)


[Learn Docker in 7 Easy Steps - Full Beginner's Tutorial](https://www.youtube.com/watch?v=gAkwW2tuIqE)

[Docker - Complete Tutorial [Docker For Everyone In 2 Hours]](https://www.youtube.com/watch?v=d-PPOS-VsC8)

[you need to learn Docker RIGHT NOW!! // Docker Containers 101](https://www.youtube.com/watch?v=eGz9DS-aIeY)

[Demystifying the Relationship Between Moby & Docker](https://collabnix.com/demystifying-the-relationship-between-moby-docker/)

[OK, I give up. Is Docker now Moby? And what is LinuxKit?](https://www.mirantis.com/blog/ok-i-give-up-is-docker-now-moby-and-what-is-linuxkit/)






